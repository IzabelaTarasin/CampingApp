@page "/reservation"
@using CampingApp.Domain;
@using CampingApp.Services;
@inject IReservationService ReservationService;

<PageTitle>@title</PageTitle>

<div class="text-center">
    <div class="mainText">
        <h1 class="display-4 text-capitalize text-black">Twoja rezerwacja</h1>
    </div>
    <div>
        <img src="<?= isset($place) ? $place->getImagePath() : '';?>" width="500" height="500">
    </div>
    <EditForm Model="@inputmodel" OnValidSubmit="@HandleValidSubmit">
        <input type="hidden" name="id">

        <label for="start">Rezerwacja od:</label>
        <InputDate @bind-Value="inputmodel.StartDate" id="start-date-input" />

        <label for="end">do:</label>
        <InputDate @bind-Value="inputmodel.EndDate" id="end-date-input" />

        <div>
            <div>
                @if (Place.AnimalsAllowed)
                {
                    <span>Przyjazne zwierzętom</span>
                }
            </div>
            <div>
                @if (Place.ReceptionExist)
                {
                    <span>Całodzienna recepcja</span>
                }
            </div>
            <div>
                @if (Place.MedicExist)
                {
                    <span>Usługi medyczne</span>
                }
            </div>
            <div>
                @if (Place.RestaurantExist)
                {
                    <span>Restauracja</span>
                }
            </div>
            <div>
                @if (Place.GrillExist)
                {
                    <span>Miejsce na ognisko lub grilla</span>
                }
            </div>
            <div>
                @if (Place.WifiExist)
                {
                    <span>WiFi</span>
                }
            </div>
            <div>
                @if (Place.SwimmingpoolExist)
                {
                    <span>Basen</span>
                }
            </div>
        </div>

        <p id="info"></p>
        <p>Total price is:</p>
        <p class="price" id="total-price"></p>

        <button class="btn btn-primary mt-1" type="submit">Anuluj</button>
    </EditForm>
</div>

@code {
    private string title = "CampApp";

    private InputModel inputmodel = new InputModel();
    private InputModel inputModelAdress = new InputModel();

    PlaceModel Place = new PlaceModel
    {
        Id = 1,
        Name = "Zielony zakątek",
        Description = "Woj. pomorskie",
        PricePerDay = 123.00,
        AnimalsAllowed = true,
        RestaurantExist = false,
        ReceptionExist = true,
        MedicExist = true,
        GrillExist = false,
        WifiExist = false,
        SwimmingpoolExist = false
    };

    private class InputModel
    {
        public int PlaceId { get; set; }
        @*public UserModel UserModel { get; set; }*@
        @*public StatusModel StatusModel { get; set; }*@
        public DateTime StartDate { get; set; }
        public DateTime EndDate { get; set; }
    }

    private async Task HandleValidSubmit()
    {
        try
        {
            var result = await ReservationService.AddReservation(
                inputmodel.PlaceId = 1,
                inputmodel.StartDate,
                inputmodel.EndDate);
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);
        }
    }

}

